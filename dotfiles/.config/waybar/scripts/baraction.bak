#!/bin/bash

HYPR_PATH=~/.config/hypr
WAYBAR_PATH=~/.config/waybar
WOFI_PATH=~/.config/wofi

THEMES="default htb"

get_next()
{
	__current_i=${__current_i:-0}
	[ $__current_i -ge $# ] && __current_i=0
	shift $__current_i
	((__current_i++))
	echo $1
}

# Check which waybar theme is set
THEMEIS=$(readlink -f $WAYBAR_PATH/style.css | xargs basename | cut -d '-' -f2)
# Check which waybar config is set
CONFIGIS=$(readlink -f $WAYBAR_PATH/config.jsonc | xargs basename | cut -d '-' -f2)

if [[ $1 == "switch" ]]; then
    SWITCHTO=$(get_next $THEMES)
    notify-send -u low "Switching Theme" "${SWITCHTO:-"Default"} theme now active"
    exit 0
fi
notify-send -u low "Error" "Â¿Desde donde se llama?"
exit 0

#if the theme is not default then we need to switch to it
# if [ $THEMEIS != "default.css" ]; then
#     SWITCHTO="-default"
# fi

#set the waybar theme
ln -sf $WAYBAR_PATH/styles/style$SWITCHTO.css $WAYBAR_PATH/style.css

# podria switchear la configuracion tambien, una base, una para estudio/trabajo, o varias sin mas
ln -sf $HYPR_PATH/configs/config$SWITCHTO.jsonc $HYPR_PATH/config.jsonc

#set the wofi theme
# ln -sf ~/.config/wofi/styles/style$SWITCHTO.css ~/.config/wofi/style.css

#set the xfce theme (leave Dracula theme for all)
# xfconf-query -c xsettings -p /Net/ThemeName -s "Adwaita$SWITCHTO"
# xfconf-query -c xsettings -p /Net/IconThemeName -s "Adwaita$SWITCHTO"

#set the GTK theme (leave Dracula theme for all)
# gsettings set org.gnome.desktop.interface gtk-theme "Adwaita$SWITCHTO"
# gsettings set org.gnome.desktop.interface icon-theme "Adwaita$SWITCHTO"

#change the background image and be cool about it ;)
# swww img ~/.config/hypr/wallpapers/${SWITCHTO:-"default"}.jpg --transition-fps 60 --transition-type wipe --transition-duration 2

notify-send -u low "Sin implementar"

#restart the waybar
killall -SIGUSR2 waybar